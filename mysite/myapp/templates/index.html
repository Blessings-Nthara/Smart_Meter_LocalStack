<!doctype html>
<html lang="en">

<head>
    <title>Smart Electricity Meter</title>
    <!-- Required meta tags -->
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />


    <!-- Datatable library -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/v/bs5/dt-1.11.5/af-2.3.7/b-2.2.2/b-html5-2.2.2/r-2.2.9/datatables.min.css" />

    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" />

    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

    <script type="text/javascript"
        src="https://cdn.datatables.net/v/bs5/dt-1.11.5/af-2.3.7/b-2.2.2/b-html5-2.2.2/r-2.2.9/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js
"></script>

    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js
"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js
"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js
"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js
"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js
"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js
"></script>

    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <style>
        html,
        body {
            height: 100%;
            width: 100%;
        }

        #myChart {
            height: 100%;
            width: 100%;
            min-height: 150px;
        }


       

        .zc-ref {
            display: none;
        }
    </style>
</head>
</head>

<body class="bg-black">
    <div id="base" class="row m-3">
        {% for customer in customers %}
        <div class="col-sm-3 p-2">
            <div class="card mb-4 bg-dark bg-gradient text-light">
                <div class="shadow card-header text-info mx-auto m-1">
                    <button type="button" class="btn btn-sm btn-dark position-relative small m-1">
                        Customer
                    </button>
                    <br />
                    {{ customer.first_name }} {{ customer.last_name }}
                    <br />
                    {{ customer.phone_number }}
                    <br />
                    {{ customer.email }}
                </div>
                <div class="card-body">
                    <div class="container">
                        <div class="shadow-lg row row-cols-2 row-cols-lg-2 g-1 g-lg-2 p-2">
                            <div class="d-grid gap-2">
                                <a value="{{customer.customer_id}}"  href="#" id="energy{{ customer.customer_id }}"
                                    class="btn btn-sm btn-outline-light">View Energy Used</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="analytics{{ customer.customer_id }}" class="btn btn-sm btn-outline-light">Analytics</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test1" class="btn btn-sm btn-outline-light ">Test</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test2" class="btn btn-sm btn-outline-light">Test</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test3" class="btn btn-sm btn-outline-light">Test</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test4" class="btn btn-sm btn-outline-light">Test</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test5" class="btn btn-sm btn-outline-light">Test</a>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="#" id="test6" class="btn btn-sm btn-outline-light">Test</a>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>

        <script>
 
            $('#energy{{customer.customer_id}}').on('click', function (e) {
                var textarea1 = document.createElement("textarea");
                textarea1.innerHTML = "{{customer.smart_meter_msn}}";
                var smart_meter_msn = textarea1.value;
               
                var textarea = document.createElement("textarea");
                textarea.innerHTML = "{{customer.customer_id}}";
                var data = textarea.value;

                $('#customer_energy').html('<div class="d-flex justify-content-center"><div class="spinner-grow text-info" role="status"><span class="visually-hidden">Loading...</span></div></div>').show().siblings('div').show()
                $("#base").hide(); 
  


                $.ajax({
                        url: '/app/energy/'+data+"/"+smart_meter_msn,
                        type: 'GET',
                        success: function(result) {
                            $('#customer_energy').html(result).show().siblings('div').show()
                            $("#base").hide();
                        }
                    }); 
            });

             
            $('#analytics{{customer.customer_id}}').on('click', function (e) {
                var textarea1 = document.createElement("textarea");
                textarea1.innerHTML = "{{customer.smart_meter_msn}}";
                var smart_meter_msn = textarea1.value;
               
                var textarea = document.createElement("textarea");
                textarea.innerHTML = "{{customer.customer_id}}";
                var data = textarea.value;

                $('#customer_analytics').html('<div class="d-flex justify-content-center"><div class="spinner-grow text-info" role="status"><span class="visually-hidden">Loading...</span></div></div>').show().siblings('div').show()
                $("#base").hide(); 
  


                $.ajax({
                        url: '/app/analytics/'+data+"/"+smart_meter_msn,
                        type: 'GET',
                        success: function(result) {
                            $('#customer_energy').html(result).show().siblings('div').show()
                            $("#base").hide();
                        }
                    }); 
            });
        </script>
        {% endfor %}

    </div>
    <div id="customer_energy" class="row m-3"></div>
</body>

</html>